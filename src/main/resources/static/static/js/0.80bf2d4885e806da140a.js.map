{"version":3,"sources":["webpack:///./src/reqeust/index.js","webpack:///./node_modules/babel-runtime/core-js/json/stringify.js","webpack:///./node_modules/core-js/library/fn/json/stringify.js"],"names":["__webpack_exports__","config","instance","axios","create","defaults","headers","post","interceptors","request","use","token","user","window","localStorage","getItem","JSON","parse","console","log","url","Message","message","type","router","push","err","response","res","data","code","status","__WEBPACK_IMPORTED_MODULE_0_axios__","__webpack_require__","__WEBPACK_IMPORTED_MODULE_0_axios___default","n","__WEBPACK_IMPORTED_MODULE_1_element_ui__","__WEBPACK_IMPORTED_MODULE_2__router__","module","exports","default","__esModule","core","$JSON","stringify","it","apply","arguments"],"mappings":"oDAAAA,EAAA,EAMO,SAAkBC,GACvB,IAAMC,EAAWC,IAAMC,SAsDvB,OApDAF,EAASG,SAASC,QAAQC,KAAK,gBAAkB,kDAIjDL,EAASM,aAAaC,QAAQC,IAAI,SAAAT,GAEhC,IAAIU,EAAQ,KACNC,EAAOC,OAAOC,aAAaC,QAAQ,QAiBzC,OAhBIH,IACFD,EAAQK,KAAKC,MAAML,GAAMD,OAGvBA,IACFV,EAAOK,QAAQK,MAAQA,GAEzBO,QAAQC,IAAIlB,GACPU,GAAwB,gBAAfV,EAAOmB,KAAwC,mBAAfnB,EAAOmB,KAA2C,iBAAfnB,EAAOmB,MACtFC,mBACEC,QAAS,WACTC,KAAM,YAERC,IAAOC,KAAK,WAGPxB,GACN,SAAAyB,GAED,OADAR,QAAQC,IAAI,SAAUO,GACfA,IAKTxB,EAASM,aAAamB,SAASjB,IAAI,SAAAkB,GASjC,OAPAV,QAAQC,IAAI,SAAUS,EAAIC,MACJ,IAAlBD,EAAIC,KAAKC,MACXT,mBACEC,QAASM,EAAIC,KAAKP,QAAU,QAC5BC,KAAM,YAGHK,EAAMA,EAAIC,KAAOD,GACvB,SAAAF,GAOD,MAN4B,MAAxBA,EAAIC,SAASI,QACfP,IAAOC,KAAK,UAEdP,QAAQC,IAAIO,EAAIC,SAASI,QACzBb,QAAQC,IAAI,eAAgBO,EAAIC,UAE1BD,IAGDxB,EAASD,IA7DlB,IAAA+B,EAAAC,EAAA,QAAAC,EAAAD,EAAAE,EAAAH,GAAAI,EAAAH,EAAA,QAAAI,GAAAJ,EAAAE,EAAAC,GAAAH,EAAA,+BCAAK,EAAAC,SAAkBC,QAAYP,EAAQ,QAAmCQ,YAAA,yBCAzE,IAAAC,EAAWT,EAAQ,QACnBU,EAAAD,EAAA1B,OAAA0B,EAAA1B,MAAuC4B,UAAA5B,KAAA4B,YACvCN,EAAAC,QAAA,SAAAM,GACA,OAAAF,EAAAC,UAAAE,MAAAH,EAAAI","file":"static/js/0.80bf2d4885e806da140a.js","sourcesContent":["import axios from 'axios'\r\n\r\nimport { Message } from 'element-ui'\r\nimport router from '@/router'\r\n\r\n// 导出request方法，供其它地方使用\r\nexport function request (config) {\r\n  const instance = axios.create()\r\n\r\n  instance.defaults.headers.post['Content-Type'] = 'application/x-www-form-urlencoded;charset=UTF-8'\r\n\r\n  // ------------------请求拦截-------------------//\r\n  // ------------在发送请求之前做些什么------------//\r\n  instance.interceptors.request.use(config => {\r\n    // 若存在token则带token\r\n    let token = null\r\n    const user = window.localStorage.getItem('user')\r\n    if (user) {\r\n      token = JSON.parse(user).token\r\n    }\r\n\r\n    if (token) {\r\n      config.headers.token = token\r\n    }\r\n    console.log(config)\r\n    if (!token && config.url !== '/user/login' && config.url !== '/user/register' && config.url !== '/user/logout') {\r\n      Message({\r\n        message: '用户未登录请登录',\r\n        type: 'warning'\r\n      })\r\n      router.push('/login')\r\n    }\r\n    // 放行\r\n    return config\r\n  }, err => {\r\n    console.log('请求拦截=>', err)\r\n    return err\r\n  })\r\n\r\n  // ------------------响应拦截-------------------//\r\n  // -------------对响应数据做点什么-------------//\r\n  instance.interceptors.response.use(res => {\r\n    // 例：后端数据处理错误，并返回错误原因；前端获取错误原因并展示\r\n    console.log('响应拦截=>', res.data)\r\n    if (res.data.code !== 0) {\r\n      Message({\r\n        message: res.data.message + '，请重试！',\r\n        type: 'warning'\r\n      })\r\n    }\r\n    return res ? res.data : res\r\n  }, err => {\r\n    if (err.response.status === 401) {\r\n      router.push('/login')\r\n    }\r\n    console.log(err.response.status)\r\n    console.log('响应拦截错误完整信息=>', err.response)\r\n    // 也可以在这里对不同的错误码做不同的展示处理\r\n    throw err\r\n  })\r\n\r\n  return instance(config)\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/reqeust/index.js","module.exports = { \"default\": require(\"core-js/library/fn/json/stringify\"), __esModule: true };\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/babel-runtime/core-js/json/stringify.js\n// module id = mvHQ\n// module chunks = 0","var core = require('../../modules/_core');\nvar $JSON = core.JSON || (core.JSON = { stringify: JSON.stringify });\nmodule.exports = function stringify(it) { // eslint-disable-line no-unused-vars\n  return $JSON.stringify.apply($JSON, arguments);\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/fn/json/stringify.js\n// module id = qkKv\n// module chunks = 0"],"sourceRoot":""}